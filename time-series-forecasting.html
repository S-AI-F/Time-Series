<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Time Series Forecasting | Time Series with R</title>
  <meta name="description" content="This is a tutorial of time series analysis with R." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Time Series Forecasting | Time Series with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial of time series analysis with R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Time Series Forecasting | Time Series with R" />
  
  <meta name="twitter:description" content="This is a tutorial of time series analysis with R." />
  

<meta name="author" content="Saif Shabou" />


<meta name="date" content="2020-12-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arma-time-serie-modeling.html"/>
<link rel="next" href="outlier-detection.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tie Series Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#what-is-a-time-series"><i class="fa fa-check"></i><b>2.1</b> What is a Time Series</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#definition"><i class="fa fa-check"></i><b>2.1.1</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#time-series-exploration"><i class="fa fa-check"></i><b>2.2</b> Time Series exploration</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#understanding-your-time-series"><i class="fa fa-check"></i><b>2.2.1</b> Understanding your Time Series</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#what-is-a-stationary-time-series"><i class="fa fa-check"></i><b>2.2.2</b> What is a Stationary Time Series ?</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction.html"><a href="introduction.html#how-to-extract-the-trend-seasonality-and-error"><i class="fa fa-check"></i><b>2.2.3</b> How to extract the trend, seasonality and error?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#time-series-patterns"><i class="fa fa-check"></i><b>2.3</b> Time Series patterns</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#how-to-de-trend-a-time-series"><i class="fa fa-check"></i><b>2.3.1</b> How to de-trend a time series ?</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#how-to-de-seasonalize-a-time-series-in-r"><i class="fa fa-check"></i><b>2.3.2</b> How to de-seasonalize a time series in R?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#auto-correlation-in-time-series-analysis"><i class="fa fa-check"></i><b>2.4</b> Auto-correlation in Time Series Analysis</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction.html"><a href="introduction.html#elementary-statistics"><i class="fa fa-check"></i><b>2.4.1</b> Elementary statistics</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction.html"><a href="introduction.html#stationarity-in-time-series-analysis"><i class="fa fa-check"></i><b>2.4.2</b> Stationarity in time series analysis</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction.html"><a href="introduction.html#auto-correlation"><i class="fa fa-check"></i><b>2.4.3</b> Auto-correlation</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#references"><i class="fa fa-check"></i><b>2.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="arma-time-serie-modeling.html"><a href="arma-time-serie-modeling.html"><i class="fa fa-check"></i><b>3</b> ARMA Time serie modeling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="arma-time-serie-modeling.html"><a href="arma-time-serie-modeling.html#auto-regressive-time-series-model"><i class="fa fa-check"></i><b>3.1</b> Auto-Regressive Time Series model</a></li>
<li class="chapter" data-level="3.2" data-path="arma-time-serie-modeling.html"><a href="arma-time-serie-modeling.html#moving-average-time-series-model"><i class="fa fa-check"></i><b>3.2</b> Moving Average Time Series Model</a></li>
<li class="chapter" data-level="3.3" data-path="arma-time-serie-modeling.html"><a href="arma-time-serie-modeling.html#model-selection-ar-or-ma"><i class="fa fa-check"></i><b>3.3</b> Model selection: AR or MA</a></li>
<li class="chapter" data-level="3.4" data-path="arma-time-serie-modeling.html"><a href="arma-time-serie-modeling.html#references-1"><i class="fa fa-check"></i><b>3.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html"><i class="fa fa-check"></i><b>4</b> Time Series Forecasting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#performance-metrics"><i class="fa fa-check"></i><b>4.2</b> Performance metrics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#forecast-errors"><i class="fa fa-check"></i><b>4.2.1</b> Forecast errors</a></li>
<li class="chapter" data-level="4.2.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#r-squared"><i class="fa fa-check"></i><b>4.2.2</b> R-squared</a></li>
<li class="chapter" data-level="4.2.3" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#mean-absolute-error-mse"><i class="fa fa-check"></i><b>4.2.3</b> Mean Absolute Error (MSE)</a></li>
<li class="chapter" data-level="4.2.4" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#median-absolute-error-medae"><i class="fa fa-check"></i><b>4.2.4</b> Median Absolute Error (MedAE)</a></li>
<li class="chapter" data-level="4.2.5" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#mean-squared-error-mse"><i class="fa fa-check"></i><b>4.2.5</b> Mean Squared Error (MSE)</a></li>
<li class="chapter" data-level="4.2.6" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#application"><i class="fa fa-check"></i><b>4.2.6</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#naive-methods"><i class="fa fa-check"></i><b>4.3</b> Naive methods</a></li>
<li class="chapter" data-level="4.4" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#exponential-smoothing"><i class="fa fa-check"></i><b>4.4</b> Exponential smoothing</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#state-space-models"><i class="fa fa-check"></i><b>4.4.1</b> State Space Models</a></li>
<li class="chapter" data-level="4.4.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#double-seasonal-holt-winters"><i class="fa fa-check"></i><b>4.4.2</b> Double seasonal Holt-Winters</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#arimasarima-models"><i class="fa fa-check"></i><b>4.5</b> ARIMA/SARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="outlier-detection.html"><a href="outlier-detection.html"><i class="fa fa-check"></i><b>5</b> Outlier Detection</a>
<ul>
<li class="chapter" data-level="5.1" data-path="outlier-detection.html"><a href="outlier-detection.html#outlier-definition"><i class="fa fa-check"></i><b>5.1</b> Outlier definition</a></li>
<li class="chapter" data-level="5.2" data-path="outlier-detection.html"><a href="outlier-detection.html#methods"><i class="fa fa-check"></i><b>5.2</b> Methods</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="outlier-detection.html"><a href="outlier-detection.html#descriptive-statistics"><i class="fa fa-check"></i><b>5.2.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="5.2.2" data-path="outlier-detection.html"><a href="outlier-detection.html#statistical-tests"><i class="fa fa-check"></i><b>5.2.2</b> Statistical tests</a></li>
<li class="chapter" data-level="5.2.3" data-path="outlier-detection.html"><a href="outlier-detection.html#proximity-based"><i class="fa fa-check"></i><b>5.2.3</b> Proximity-based</a></li>
<li class="chapter" data-level="5.2.4" data-path="outlier-detection.html"><a href="outlier-detection.html#machine-learning-models"><i class="fa fa-check"></i><b>5.2.4</b> Machine learning models</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="outlier-detection.html"><a href="outlier-detection.html#references-2"><i class="fa fa-check"></i><b>5.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html"><i class="fa fa-check"></i><b>6</b> Outlier detection in Time series</a>
<ul>
<li class="chapter" data-level="6.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#definition-1"><i class="fa fa-check"></i><b>6.1.1</b> Definition</a></li>
<li class="chapter" data-level="6.1.2" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#taxonomy"><i class="fa fa-check"></i><b>6.1.2</b> Taxonomy</a></li>
<li class="chapter" data-level="6.1.3" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#globa-vs-local-anomalies"><i class="fa fa-check"></i><b>6.1.3</b> Globa VS local anomalies</a></li>
<li class="chapter" data-level="6.1.4" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#univariate-vs-multivariate"><i class="fa fa-check"></i><b>6.1.4</b> Univariate VS Multivariate</a></li>
<li class="chapter" data-level="6.1.5" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#evaluation-metrics"><i class="fa fa-check"></i><b>6.1.5</b> Evaluation metrics</a></li>
<li class="chapter" data-level="6.1.6" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#types-of-anomalies-in-time-series"><i class="fa fa-check"></i><b>6.1.6</b> Types of anomalies in time series</a></li>
<li class="chapter" data-level="6.1.7" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#methodological-approaches"><i class="fa fa-check"></i><b>6.1.7</b> Methodological Approaches</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#statistical-based-approaches"><i class="fa fa-check"></i><b>6.2</b> Statistical-based approaches</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#stl-decomposition"><i class="fa fa-check"></i><b>6.2.1</b> STL decomposition</a></li>
<li class="chapter" data-level="6.2.2" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#generalized-esd-test-for-outliers"><i class="fa fa-check"></i><b>6.2.2</b> Generalized ESD Test for Outliers</a></li>
<li class="chapter" data-level="6.2.3" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#extreme-studentized-deviate-technique-esd"><i class="fa fa-check"></i><b>6.2.3</b> Extreme Studentized Deviate Technique (ESD)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#forecasting-based-approaches"><i class="fa fa-check"></i><b>6.3</b> Forecasting-based approaches</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#moving-average-method"><i class="fa fa-check"></i><b>6.3.1</b> Moving Average Method</a></li>
<li class="chapter" data-level="6.3.2" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#arma"><i class="fa fa-check"></i><b>6.3.2</b> ARMA</a></li>
<li class="chapter" data-level="6.3.3" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#prophet"><i class="fa fa-check"></i><b>6.3.3</b> Prophet</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#neural-network-based-approaches"><i class="fa fa-check"></i><b>6.4</b> Neural Network Based Approaches</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#autoencoder"><i class="fa fa-check"></i><b>6.4.1</b> Autoencoder</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#clustering-based-approaches"><i class="fa fa-check"></i><b>6.5</b> Clustering Based Approaches</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#kmeans"><i class="fa fa-check"></i><b>6.5.1</b> Kmeans</a></li>
<li class="chapter" data-level="6.5.2" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#gaussina-mixture-model-gmm"><i class="fa fa-check"></i><b>6.5.2</b> Gaussina Mixture Model (GMM)</a></li>
<li class="chapter" data-level="6.5.3" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#dbscan-1"><i class="fa fa-check"></i><b>6.5.3</b> DBSCAN</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#proximity-based-approaches"><i class="fa fa-check"></i><b>6.6</b> Proximity Based Approaches</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#k-nearest-neighbor"><i class="fa fa-check"></i><b>6.6.1</b> K-Nearest neighbor:</a></li>
<li class="chapter" data-level="6.6.2" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#local-outlier-factor-lof"><i class="fa fa-check"></i><b>6.6.2</b> Local Outlier Factor (LOF)</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#tree-based-approaches"><i class="fa fa-check"></i><b>6.7</b> Tree Based Approaches</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#isolation-forest"><i class="fa fa-check"></i><b>6.7.1</b> Isolation Forest</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#dimension-reduction-based-approaches"><i class="fa fa-check"></i><b>6.8</b> Dimension Reduction Based Approaches</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#principal-component-analyses-pca"><i class="fa fa-check"></i><b>6.8.1</b> Principal Component Analyses (PCA)</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="outlier-detection-in-time-series.html"><a href="outlier-detection-in-time-series.html#references-3"><i class="fa fa-check"></i><b>6.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-4.html"><a href="references-4.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-forecasting" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Time Series Forecasting</h1>
<div id="introduction-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<ul>
<li>The <strong>Forecast</strong> package is the most complete forecasting package available on R or Python.</li>
</ul>
</div>
<div id="performance-metrics" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Performance metrics</h2>
<div id="forecast-errors" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Forecast errors</h3>
<p>A forecast “error” is the difference between an observed value and its forecast. Here “error” does not mean a mistake, it means the unpredictable part of an observation.</p>
</div>
<div id="r-squared" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> R-squared</h3>
<p><span class="math display">\[R^2 = 1 - \frac{SS_{res}}{SS_{tot}}\]</span></p>
<p>where <span class="math inline">\(SS_{res}\)</span> is the sum of squared residuals from the predicted values and <span class="math inline">\({SS_{tot}\)</span> is the sum of squared deviations of the dependent variable from the sample mean. It means how much of the variance in the dependent variable can explain the variance in the independent variable. High value means the variance in the model is similar to the variance in the true values and if the R2 value is low it means that the two values are not much correlated.</p>
<p>The important point to note in the case of R-squared is that, it does not show if the model is satisfactory future predictions or not. It shows if the model is a good fit observed values and how good of a “fit” it is. High <span class="math inline">\(R^2\)</span> means that the correlation between observed and predicted values is high.</p>
</div>
<div id="mean-absolute-error-mse" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Mean Absolute Error (MSE)</h3>
<p>Mean absolute error is the average of the absolute values of the deviation. This type of error measurement is useful when measuring prediction errors in the same unit as the original series. See the below formula</p>
<p><span class="math display">\[MAE = \frac{\sum_{i = 0}^{n} |y_i - \hat{y_i}|}{n}\]</span>
Thus MAE will tell you how big of an error can you expect from the forecast on average.</p>
</div>
<div id="median-absolute-error-medae" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Median Absolute Error (MedAE)</h3>
<p>Median absolute error(MedAE) is similar to the MAE. To calculate MedAE, take the absolute differences and then find the median value.</p>
<p><span class="math display">\[MedAE = median(|y_1 - \hat{y_1}|,|y_2 - \hat{y_2}|,...,|y_n - \hat{y_n}|)\]</span></p>
<p>Using median is an extreme way of triming extreme values. Hence median absolute error reduces the bias in favor of low forecasts.</p>
</div>
<div id="mean-squared-error-mse" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Mean Squared Error (MSE)</h3>
<p>The mean squared error is the average of the square of the forecast error. As the square of the errors are taken, the effect is that larger errors have more weight on the score.</p>
<p><span class="math display">\[MSE = \frac{\sum_{i = 0}^{n} (y_i - \hat{y_i})^2}{n}\]</span></p>
<p>Since both MSE and RMSE takes the square of the errors, outliers will have a huge effect on the resulting error.</p>
<div id="mean-absolute-percentage-error-mape" class="section level4" number="4.2.5.1">
<h4><span class="header-section-number">4.2.5.1</span> Mean Absolute Percentage Error (MAPE)</h4>
<p>As this is a percentage error and hence gives a good idea of the relative error. Percentage errors have the advantage of being unit-free, and so are frequently used to compare forecast performances between data sets.</p>
<p><span class="math display">\[MAPE = \frac{100%}{n}\sum_{i = 1}^{n} \frac{y_i - \hat{y_i}}{y_i}\]</span></p>
</div>
</div>
<div id="application" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Application</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="time-series-forecasting.html#cb72-1" aria-hidden="true"></a><span class="kw">library</span>(forecast)</span>
<span id="cb72-2"><a href="time-series-forecasting.html#cb72-2" aria-hidden="true"></a><span class="kw">library</span>(MLmetrics)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MLmetrics&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     Recall</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="time-series-forecasting.html#cb75-1" aria-hidden="true"></a>data=AirPassengers</span>
<span id="cb75-2"><a href="time-series-forecasting.html#cb75-2" aria-hidden="true"></a></span>
<span id="cb75-3"><a href="time-series-forecasting.html#cb75-3" aria-hidden="true"></a><span class="co">#Create samples</span></span>
<span id="cb75-4"><a href="time-series-forecasting.html#cb75-4" aria-hidden="true"></a>training=<span class="kw">window</span>(data, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1949</span>,<span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">1955</span>,<span class="dv">12</span>))</span>
<span id="cb75-5"><a href="time-series-forecasting.html#cb75-5" aria-hidden="true"></a>validation=<span class="kw">window</span>(data, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1956</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
</div>
<div id="naive-methods" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Naive methods</h2>
<p>Any forecasting method should be evaluated by being compared to a naive method. This elps ensure that the efforts put in having a more complex mdoel are worth in terms of performance:</p>
<ul>
<li>Simple naive: the forecast for tomorrow is what we are observing today.</li>
<li>Seasonal naive: the forecast of tomorrow is what we observed the week/mont/year (depending what horizon we are working with) before.</li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="time-series-forecasting.html#cb76-1" aria-hidden="true"></a>naive =<span class="st"> </span><span class="kw">snaive</span>(training, <span class="dt">h=</span><span class="kw">length</span>(validation))</span>
<span id="cb76-2"><a href="time-series-forecasting.html#cb76-2" aria-hidden="true"></a><span class="kw">MAPE</span>(naive<span class="op">$</span>mean, validation) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 27.04689</code></pre>
<p>That gves us a MAPE of 27.04%. That is the score to beat.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="time-series-forecasting.html#cb78-1" aria-hidden="true"></a><span class="kw">plot</span>(data, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Passengers&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Seasonal Naive Forecast&quot;</span>, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</span>
<span id="cb78-2"><a href="time-series-forecasting.html#cb78-2" aria-hidden="true"></a><span class="kw">lines</span>(naive<span class="op">$</span>mean, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="TimeSerieAnalysis-Book_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="exponential-smoothing" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Exponential smoothing</h2>
<ul>
<li><p>Forecats produced using exponential smoothing methods are weighted average of past observations, with the weights decaying exponentially as the observations get older. In other words, the more recent the obserbation the higher the associated weight.</p></li>
<li><p><a href="https://otexts.com/fpp2/expsmooth.html" class="uri">https://otexts.com/fpp2/expsmooth.html</a></p></li>
<li><p>Simple, Double and Triple exponential smoothing can be performed using the HoltWinters() function.</p></li>
</ul>
<div id="state-space-models" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> State Space Models</h3>
<p>With the Forecast Package, smoothing methods can be placed within the structure of state space models. By using this structure, we can find the optimal exponential smoothing model, using the ets function.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="time-series-forecasting.html#cb79-1" aria-hidden="true"></a>ets_model =<span class="st"> </span><span class="kw">ets</span>(training, <span class="dt">allow.multiplicative.trend =</span> <span class="ot">TRUE</span>)</span>
<span id="cb79-2"><a href="time-series-forecasting.html#cb79-2" aria-hidden="true"></a><span class="kw">summary</span>(ets_model)</span></code></pre></div>
<pre><code>## ETS(M,Md,M) 
## 
## Call:
##  ets(y = training, allow.multiplicative.trend = TRUE) 
## 
##   Smoothing parameters:
##     alpha = 0.6749 
##     beta  = 0.0082 
##     gamma = 1e-04 
##     phi   = 0.98 
## 
##   Initial states:
##     l = 119.9101 
##     b = 1.0177 
##     s = 0.9065 0.7973 0.9184 1.0524 1.1863 1.1987
##            1.0896 0.9798 0.9957 1.046 0.9167 0.9126
## 
##   sigma:  0.0395
## 
##      AIC     AICc      BIC 
## 726.4475 736.9706 770.2022 
## 
## Training set error measures:
##                     ME     RMSE      MAE       MPE     MAPE      MASE      ACF1
## Training set 0.9845273 7.241276 5.726611 0.2712157 2.907857 0.2145244 0.0453492</code></pre>
<p>We see ETS (M, Md, M). This means we have an ets model with multiplicative errors, a multiplicative trend and a multiplicative seasonality. Basically, mutliplicative means that the parameter is “amplified” over time.</p>
<p>Here is how to forecast using the estimated optimal smoothing model:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="time-series-forecasting.html#cb81-1" aria-hidden="true"></a>ets_forecast =<span class="st"> </span><span class="kw">forecast</span>(ets_model, <span class="dt">h=</span><span class="kw">length</span>(validation))</span>
<span id="cb81-2"><a href="time-series-forecasting.html#cb81-2" aria-hidden="true"></a></span>
<span id="cb81-3"><a href="time-series-forecasting.html#cb81-3" aria-hidden="true"></a><span class="co"># plot</span></span>
<span id="cb81-4"><a href="time-series-forecasting.html#cb81-4" aria-hidden="true"></a><span class="kw">plot</span>(data, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Passengers&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Seasonal Naive Forecast&quot;</span>, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</span>
<span id="cb81-5"><a href="time-series-forecasting.html#cb81-5" aria-hidden="true"></a><span class="kw">lines</span>(ets_forecast<span class="op">$</span>mean, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="TimeSerieAnalysis-Book_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="time-series-forecasting.html#cb82-1" aria-hidden="true"></a><span class="co"># error</span></span>
<span id="cb82-2"><a href="time-series-forecasting.html#cb82-2" aria-hidden="true"></a><span class="kw">MAPE</span>(ets_forecast<span class="op">$</span>mean, validation) <span class="op">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 12.59147</code></pre>
<p>We see that the upward trend in demand is being capture a little bit (far from perfect, better than naive). It gives an MAPE of 12.6%.</p>
</div>
<div id="double-seasonal-holt-winters" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Double seasonal Holt-Winters</h3>
<p>The ets function only allows for one seasonality. Sometimes, the data we have can be composed of multiple seasonalities (monthly and yearly for instance).</p>
<p>Double Seasonal Holt-Winters (DSHW) allows for two seasonalities: a smaller one repeated often and a bigger one repeated less often. For the method to work however, the seasonalities need to be nested, meaning one must be an integer multiple of the other (2 and 4, 24 and 168, etc.).</p>
<p>The code here is a bit different since we need to specify the lenghts of our two seasonalities (which is not always something we know) and the forecast is computed directly when creating the model with the dshw function.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="time-series-forecasting.html#cb84-1" aria-hidden="true"></a>dshw_model =<span class="st"> </span><span class="kw">dshw</span>(training, <span class="dt">period1=</span><span class="dv">4</span>, <span class="dt">period2 =</span> <span class="dv">12</span>, <span class="dt">h=</span><span class="kw">length</span>(validation))</span>
<span id="cb84-2"><a href="time-series-forecasting.html#cb84-2" aria-hidden="true"></a><span class="kw">MAPE</span>(dshw_model<span class="op">$</span>mean, validation)<span class="op">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 3.27219</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="time-series-forecasting.html#cb86-1" aria-hidden="true"></a><span class="co"># plot </span></span>
<span id="cb86-2"><a href="time-series-forecasting.html#cb86-2" aria-hidden="true"></a><span class="kw">plot</span>(data, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Passengers&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Seasonal Naive Forecast&quot;</span>, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</span>
<span id="cb86-3"><a href="time-series-forecasting.html#cb86-3" aria-hidden="true"></a><span class="kw">lines</span>(dshw_model<span class="op">$</span>mean, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="TimeSerieAnalysis-Book_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>We get a MAPE of 3.7% with this method!</p>
</div>
</div>
<div id="arimasarima-models" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> ARIMA/SARIMA models</h2>
<p>ARIM models contain 3 things:</p>
<ul>
<li><strong>AR (p)</strong>: Autoregressive part of the model. Means that we use <strong>p</strong> past observations from the timeseries as predictors</li>
<li><strong>Differenciating (d)</strong>: Used to transform the timeseries into a strationary one by taking the differences between successive observations at appropriate lags (d).</li>
<li><strong>MA (q)</strong>: uses <strong>q</strong> past forecast errors as predicators</li>
</ul>
<p>That’s it for ARIMA but if you know the data you have is seasonal, then you need more. That’s where SARIMA comes into play. SARIMA adds a seasonal part to the model.</p>
<p>The auto.arima function can be used to return the best estimated model. Here is the code:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="time-series-forecasting.html#cb87-1" aria-hidden="true"></a>arima_optimal =<span class="st"> </span><span class="kw">auto.arima</span>(training)</span></code></pre></div>
<p>To forecast a SARIMA model (which is what we have here since we have a seasonal part), we can use the sarima.for function from the astsa package.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="time-series-forecasting.html#cb88-1" aria-hidden="true"></a><span class="kw">library</span>(astsa)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;astsa&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:forecast&#39;:
## 
##     gas</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="time-series-forecasting.html#cb91-1" aria-hidden="true"></a>sarima_forecast =<span class="st"> </span><span class="kw">sarima.for</span>(training, <span class="dt">n.ahead=</span><span class="kw">length</span>(validation),</span>
<span id="cb91-2"><a href="time-series-forecasting.html#cb91-2" aria-hidden="true"></a>                             <span class="dt">p=</span><span class="dv">0</span>,<span class="dt">d=</span><span class="dv">1</span>,<span class="dt">q=</span><span class="dv">1</span>,<span class="dt">P=</span><span class="dv">1</span>,<span class="dt">D=</span><span class="dv">1</span>,<span class="dt">Q=</span><span class="dv">0</span>,<span class="dt">S=</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="TimeSerieAnalysis-Book_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="time-series-forecasting.html#cb92-1" aria-hidden="true"></a><span class="kw">MAPE</span>(sarima_forecast<span class="op">$</span>pred, validation) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 6.544624</code></pre>
<p>We get a MAPE of 6.5% with this SARIMA model.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arma-time-serie-modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="outlier-detection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TimeSerieAnalysis-Book.pdf", "TimeSerieAnalysis-Book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
